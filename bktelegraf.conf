[[inputs.mqtt_consumer]]
  servers = ["tcp://mqtt-2.omnivoltaic.com:1883"]
  topics = ["#"]
  data_format = "json_v2"

  [[inputs.mqtt_consumer.json_v2]]
    measurement_name = "mqtt_consumer"
    measurement_name_path = ""
    timestamp_path = ""
    timestamp_format = "2006-1-2 15:04:05"
    timestamp_timezone = "UTC"

    # Attributes
    [[inputs.mqtt_consumer.json_v2.field]]
      path = "att.opid"

    [[inputs.mqtt_consumer.json_v2.field]]
      path = "att.ppid"
      rename = "PAYG Device ID"
      type = "string"

    [[inputs.mqtt_consumer.json_v2.field]]
      path = "att.flid"
      rename = "Fleet ID"
      type = "string"

    [[inputs.mqtt_consumer.json_v2.field]]
      path = "att.frmv"
      rename = "Firmware Version"
      type = "string"

    [[inputs.mqtt_consumer.json_v2.tag]]
      path = "att"
      rename = "Attributes"

    # Commands
    [[inputs.mqtt_consumer.json_v2.field]]
      path = "cmd.gstw"
      rename = "GPRS Sleep Time Window"
      type = "int"

    [[inputs.mqtt_consumer.json_v2.field]]
      path = "cmd.gctw"
      rename = "GPRS Connect Time Window"
      type = "int"

    [[inputs.mqtt_consumer.json_v2.field]]
      path = "cmd.napn"
      rename = "GPRS Carrier APN Name and Passcode"
      type = "string"

    [[inputs.mqtt_consumer.json_v2.field]]
      path = "cmd.swch"
      rename = "Generic Device Switch"
      type = "int"

    [[inputs.mqtt_consumer.json_v2.field]]
      path = "cmd.read"
      rename = "Last Read Request"
      type = "int"

    [[inputs.mqtt_consumer.json_v2.field]]
      path = "cmd.rptm"
      rename = "Set Notification Request"
      type = "int"

    [[inputs.mqtt_consumer.json_v2.field]]
      path = "cmd.hbfq"
      rename = "Heart Beat"
      type = "int"

    # Status
    [[inputs.mqtt_consumer.json_v2.field]]
      path = "sts.sstc"
      rename = "System Status Code"
      type = "int"

    [[inputs.mqtt_consumer.json_v2.field]]
      path = "sts.crtm"
      rename = "created at time"
      type = "string"

    [[inputs.mqtt_consumer.json_v2.field]]
      path = "sts.udtm"
      rename = "update at time"
      type = "string"

    [[inputs.mqtt_consumer.json_v2.field]]
      path = "sts.plat"
      rename = "Device GPS Latitude"
      type = "float"

    [[inputs.mqtt_consumer.json_v2.field]]
      path = "sts.plon"
      rename = "Device GPS Longitude"
      type = "float"

    [[inputs.mqtt_consumer.json_v2.field]]
      path = "sts.gpss"
      rename = "GPS Signal Strength in db"
      type = "int"

    [[inputs.mqtt_consumer.json_v2.field]]
      path = "sts.gpfc"
      rename = "GPRS Connect Failure Counts"
      type = "int"

    [[inputs.mqtt_consumer.json_v2.field]]
      path = "sts.rcrd"
      rename = "Remaining Credit Days"
      type = "int"

    [[inputs.mqtt_consumer.json_v2.field]]
      path = "sts.trhd"
      rename = "Total Running History Days"
      type = "int"

    [[inputs.mqtt_consumer.json_v2.field]]
      path = "sts.tpgd"
      rename = "PAYG Running Days"
      type = "int"

    [[inputs.mqtt_consumer.json_v2.field]]
      path = "sts.pgst"
      rename = "PAYG State"
      type = "int"

    [[inputs.mqtt_consumer.json_v2.field]]
      path = "sts.tkre"
      rename = "Token Request"
      type = "string"

    [[inputs.mqtt_consumer.json_v2.field]]
      path = "sts.ocst"
      rename = "Device Output State"
      type = "int"

    # Data
    [[inputs.mqtt_consumer.json_v2.field]]
      path = "dta.batp"
      rename = "Battery Net Charging Power"
      type = "int"

    [[inputs.mqtt_consumer.json_v2.field]]
      path = "dta.inpp"
      rename = "Total Input Power W"
      type = "int"

    [[inputs.mqtt_consumer.json_v2.field]]
      path = "dta.outp"
      rename = "Output Power W"
      type = "int"

    [[inputs.mqtt_consumer.json_v2.field]]
      path = "dta.aeng"
      rename = "Accumulated Energy Output in Whs"
      type = "int"

    [[inputs.mqtt_consumer.json_v2.field]]
      path = "dta.pckv"
      rename = "Pack Voltage mV"
      type = "int"

    [[inputs.mqtt_consumer.json_v2.field]]
      path = "dta.pckc"
      rename = "Pack Current in mA"
      type = "int"

    [[inputs.mqtt_consumer.json_v2.field]]
      path = "dta.rsoc"
      rename = "Relative State of Charge"
      type = "int"

    [[inputs.mqtt_consumer.json_v2.field]]
      path = "dta.rcap"
      rename = "Remaining Capacity in Whs"
      type = "int"

    [[inputs.mqtt_consumer.json_v2.field]]
      path = "dta.fccp"
      rename = "Full Charge Capacity in Whs"
      type = "int"

    [[inputs.mqtt_consumer.json_v2.field]]
      path = "dta.pckt"
      rename = "Pack Temperature in Celsius"
      type = "int"

    [[inputs.mqtt_consumer.json_v2.field]]
      path = "dta.acyc"
      rename = "Accumulated Cycles"
      type = "int"

    # Diagnostics
    [[inputs.mqtt_consumer.json_v2.field]]
      path = "dia.cv01"
      rename = "Cell 01 Voltage"
      type = "int"

    [[inputs.mqtt_consumer.json_v2.field]]
      path = "dia.cv02"
      rename = "Cell 02 Voltage"
      type = "int"

    [[inputs.mqtt_consumer.json_v2.field]]
      path = "dia.cv03"
      rename = "Cell 03 Voltage"
      type = "int"

    [[inputs.mqtt_consumer.json_v2.field]]
      path = "dia.cv04"
      rename = "Cell 04 Voltage"
      type = "int"

    [[inputs.mqtt_consumer.json_v2.field]]
      path = "dia.cv05"
      rename = "Cell 05 Voltage"
      type = "int"

    [[inputs.mqtt_consumer.json_v2.field]]
      path = "dia.cv06"
      rename = "Cell 06 Voltage"
      type = "int"

    [[inputs.mqtt_consumer.json_v2.field]]
      path = "dia.cv07"
      rename = "Cell 07 Voltage"
      type = "int"

    [[inputs.mqtt_consumer.json_v2.field]]
      path = "dia.cv08"
      rename = "Cell 08 Voltage"
      type = "int"

    [[inputs.mqtt_consumer.json_v2.field]]
      path = "dia.cv09"
      rename = "Cell 09 Voltage"
      type = "int"

    [[inputs.mqtt_consumer.json_v2.field]]
      path = "dia.cv10"
      rename = "Cell 10 Voltage"
      type = "int"

    [[inputs.mqtt_consumer.json_v2.field]]
      path = "dia.cv11"
      rename = "Cell 11 Voltage"
      type = "int"

    [[inputs.mqtt_consumer.json_v2.field]]
      path = "dia.cv12"
      rename = "Cell 12 Voltage"
      type = "int"

    [[inputs.mqtt_consumer.json_v2.field]]
      path = "dia.cv13"
      rename = "Cell 13 Voltage"
      type = "int"

    [[inputs.mqtt_consumer.json_v2.field]]
      path = "dia.cv14"
      rename = "Cell 14 Voltage"
      type = "int"

    [[inputs.mqtt_consumer.json_v2.field]]
      path = "dia.cv15"
      rename = "Cell 15 Voltage"
      type = "int"

    [[inputs.mqtt_consumer.json_v2.field]]
      path = "dia.cv16"
      rename = "Cell 16 Voltage"
      type = "int"

    [[inputs.mqtt_consumer.json_v2.field]]
      path = "dia.cv17"
      rename = "Cell 17 Voltage"
      type = "int"

    [[inputs.mqtt_consumer.json_v2.field]]
      path = "dia.cv18"
      rename = "Cell 18 Voltage"
      type = "int"

    [[inputs.mqtt_consumer.json_v2.field]]
      path = "dia.cv19"
      rename = "Cell 19 Voltage"
      type = "int"

    [[inputs.mqtt_consumer.json_v2.field]]
      path = "dia.cv20"
      rename = "Cell 20 Voltage"
      type = "int"


  ## Optional: If you want to explicitly specify string fields in the output, you can use the following:
  # json_string_fields = ["att.opid", "att.ppid", "att.flid", "att.frmv", "cmd.pubk", "cmd.napn", "sts.crtm", "sts.udtm", "sts.time", "dta.sstm"]
# # Configuration for sending metrics to InfluxDB
[[outputs.influxdb_v2]]
  ## The URLs of the InfluxDB cluster nodes.
  ##
  ## Multiple URLs can be specified for a single cluster, only ONE of the
  ## urls will be written to each interval.
  ##   ex: urls = ["https://us-west-2-1.aws.cloud2.influxdata.com"]
  urls = ["http://${DOCKER_INFLUXDB_INIT_HOST}:${DOCKER_INFLUXDB_INIT_PORT}"]

  ## Token for authentication.
  token = "$DOCKER_INFLUXDB_INIT_ADMIN_TOKEN"

  ## Organization is the name of the organization you wish to write to; must exist.
  organization = "$DOCKER_INFLUXDB_INIT_ORG"

  ## Destination bucket to write into.
  bucket = "$DOCKER_INFLUXDB_INIT_BUCKET"





# [[inputs.mqtt_consumer]]
#   servers = ["tcp://mqtt-2.omnivoltaic.com:1883"]
#   topics = ["#"]
#   data_format = "json_v2"

# # [[inputs.file]]
# #   files = ["/fields.json"]
# #   data_format = "json_v2"  # Updated to match the data format used in the file input

# [[inputs.file.json]]
#   measurement_name = "omnivoltaic_device"

#   [[inputs.file.json.tag]]
#     path = "att.opid"
#     rename = "att_opid"

#   [[inputs.file.json.field]]
#     path = "cmd.pubk"
#     rename = "cmd_pubk"
#     type = "string"

# [[outputs.influxdb_v2]]
#   urls = ["http://influxdb:8086"]
#   token = "72634f97852549cf138c59fe330001efb6d8d63004f069bb30c2955bb540e434"
#   organization = "oves"
#   bucket = "telegraf"

# [[processors.converter]]
#   [processors.converter.fields]
#     # Att JSON data
#     "att_opid" = "att.opid"
#     "att_ppid" = "att.ppid"
#     "att_flid" = "att.flid"
#     "att_frmV" = "att.frmV"

#     # Cmd JSON data
#     "cmd_pubk" = "cmd.pubk"
#     "cmd_gstw" = "cmd.gstw"
#     "cmd_gctw" = "cmd.gctw"
#     "cmd_raml" = "cmd.raml"
#     "cmd_ramt" = "cmd.ramt"
#     "cmd_alml" = "cmd.alml"
#     "cmd_napn" = "cmd.napn"
#     "cmd_swch" = "cmd.swch"
#     "cmd_read" = "cmd.read"
#     "cmd_rptm" = "cmd.rptm"
#     "cmd_hbfq" = "cmd.hbfq"

#     # Sts JSON data
#     "sts_sstc" = "sts.sstc"
#     "sts_crtm" = "sts.crtm"
#     "sts_udtm" = "sts.udtm"
#     "sts_time" = "sts.time"
#     "sts_plat" = "sts.plat"
#     "sts_plon" = "sts.plon"
#     "sts_gpss" = "sts.gpss"
#     "sts_gpfc" = "sts.gpfc"
#     "sts_rcrd" = "sts.rcrd"
#     "sts_trhd" = "sts.trhd"
#     "sts_tpgd" = "sts.tpgd"
#     "sts_pgst" = "sts.pgst"
#     "sts_tkre" = "sts.tkre"
#     "sts_ocst" = "sts.ocst"

#     # Dta JSON data
#     "dta_batp" = "dta.batp"
#     "dta_inpp" = "dta.inpp"
#     "dta_outp" = "dta.outp"
#     "dta_aeng" = "dta.aeng"
#     "dta_pckv" = "dta.pckv"
#     "dta_pckc" = "dta.pckc"
#     "dta_rsoc" = "dta.rsoc"
#     "dta_rcap" = "dta.rcap"
#     "dta_fccp" = "dta.fccp"
#     "dta_pckt" = "dta.pckt"
#     "dta_acyc" = "dta.acyc"

#     # Dia JSON data
#     "dia_cv01" = "dia.cv01"
#     "dia_cv02" = "dia.cv02"
#     "dia_cv03" = "dia.cv03"
#     "dia_cv04" = "dia.cv04"
#     "dia_cv05" = "dia.cv05"
#     "dia_cv06" = "dia.cv06"
#     "dia_cv07" = "dia.cv07"
#   [processors.converter.tags]




# [[inputs.mqtt_consumer]]
#   servers = ["tcp://mqtt-2.omnivoltaic.com:1883"]
#   topics = ["#"]
#   data_format = "json"

# [[inputs.file]]
#   files = ["/path/to/your/json_file.json"]
#   data_format = "json"
  
#   [[inputs.file.json]]
#     measurement_name = "your_measurement"
#     timestamp_path = "timestamp"
#     timestamp_format = "2006-01-02T15:04:05Z07:00"

#     [[inputs.file.json.field]]
#       path = "value"
#       rename = "new_value_name"
#       type = "integer"

#     [[inputs.file.json.tag]]
#       path = "tag"
#       rename = "new_tag_name"





# [[inputs.mqtt_consumer]]
#   servers = ["tcp://mqtt-2.omnivoltaic.com:1883"]
#   topics = ["#"]
#   data_format = "json_v2"

#   [[inputs.mqtt_consumer.json_v2]]
#     measurement_name = "mqtt_consumer"
#     measurement_name_path = ""
#     timestamp_path = ""
#     timestamp_format = "2006-1-2 15:04:05"
#     timestamp_timezone = "UTC"

#     [[inputs.file.json_v2.field]]

#     [inputs.mqtt_consumer.json_v2.object]
#       path = "att" # Set the appropriate path to your JSON data structure

#     [inputs.mqtt_consumer.json_v2.object.renames]
#       att.opid = "opid"
#       att.ppid = "ppid"
#       att.flid = "flid"
#       att.frmv = "frmv"

#     [inputs.mqtt_consumer.json_v2.object.fields]
#       att.opid = "string"
#       att.ppid = "string"
#       att.flid = "string"
#       att.frmv = "string"

#     [inputs.mqtt_consumer.json_v2.object]
#       path = "cmd"

#     [inputs.mqtt_consumer.json_v2.object.renames]
#       cmd.pubk = "pubk"
#       cmd.gstw = "gstw"
#       cmd.gctw = "gctw"
#       cmd.napn = "napn"
#       cmd.swch = "swch"
#       cmd.read = "read"
#       cmd.rptm = "rptm"
#       cmd.hbfq = "hbfq"

#     [inputs.mqtt_consumer.json_v2.object.fields]
#       cmd.pubk = "string"
#       cmd.gstw = "int"
#       cmd.gctw = "int"
#       cmd.napn = "string"
#       cmd.swch = "int"
#       cmd.read = "int"
#       cmd.rptm = "int"
#       cmd.hbfq = "int"

#     [inputs.mqtt_consumer.json_v2.object]
#       path = "sts"

#     [inputs.mqtt_consumer.json_v2.object.renames]
#       sts.sstc = "sstc"
#       sts.crtm = "crtm"
#       sts.udtm = "udtm"
#       sts.time = "time"
#       sts.plat = "plat"
#       sts.plon = "plon"
#       sts.gpss = "gpss"
#       sts.gpfc = "gpfc"
#       sts.rcrd = "rcrd"
#       sts.trhd = "trhd"
#       sts.tpgd = "tpgd"
#       sts.pgst = "pgst"
#       sts.tkre = "tkre"
#       sts.ocst = "ocst"

#     [inputs.mqtt_consumer.json_v2.object.fields]
#       sts.sstc = "int"
#       sts.crtm = "string"
#       sts.udtm = "string"
#       sts.time = "string"
#       sts.plat = "float"
#       sts.plon = "float"
#       sts.gpss = "int"
#       sts.gpfc = "int"
#       sts.rcrd = "int"
#       sts.trhd = "int"
#       sts.tpgd = "int"
#       sts.pgst = "int"
#       sts.tkre = "int"
#       sts.ocst = "int"

#     [inputs.mqtt_consumer.json_v2.object]
#       path = "dta"

#     [inputs.mqtt_consumer.json_v2.object.renames]
#       dta.batp = "batp"
#       dta.inpp = "inpp"
#       dta.outp = "outp"
#       dta.aeng = "aeng"
#       dta.pckv = "pckv"
#       dta.pckc = "pckc"
#       dta.rsoc = "rsoc"
#       dta.rcap = "rcap"
#       dta.fccp = "fccp"
#       dta.pckt = "pckt"
#       dta.acyc = "acyc"

#     [inputs.mqtt_consumer.json_v2.object.fields]
#       dta.batp = "int"
#       dta.inpp = "int"
#       dta.outp = "int"
#       dta.aeng = "int"
#       dta.pckv = "int"
#       dta.pckc = "int"
#       dta.rsoc = "int"
#       dta.rcap = "int"
#       dta.fccp = "int"
#       dta.pckt = "int"
#       dta.acyc = "int"

#     [inputs.mqtt_consumer.json_v2.object]
#       path = "dia"

#     [inputs.mqtt_consumer.json_v2.object.renames]
#       dia.cv01 = "cv01"
#       dia.cv02 = "cv02"
#       dia.cv03 = "cv03"
#       dia.cv04 = "cv04"
#       dia.cv05 = "cv05"
#       dia.cv06 = "cv06"
#       dia.cv07 = "cv07"
#       dia.cv08 = "cv08"
#       dia.cv09 = "cv09"
#       dia.cv10 = "cv10"
#       dia.cv11 = "cv11"
#       dia.cv12 = "cv12"
#       dia.cv13 = "cv13"
#       dia.cv14 = "cv14"
#       dia.cv15 = "cv15"
#       dia.cv16 = "cv16"

#     [inputs.mqtt_consumer.json_v2.object.fields]
#       dia.cv01 = "int"
#       dia.cv02 = "int"
#       dia.cv03 = "int"
#       dia.cv04 = "int"
#       dia.cv05 = "int"

# # Configuration for sending metrics to InfluxDB
# [[outputs.influxdb_v2]]
#   urls = ["http://influxdb:8086"]
#   token = "72634f97852549cf138c59fe330001efb6d8d63004f069bb30c2955bb540e434"
#   organization = "oves"
#   bucket = "telegraf"

